import{r as g,f as zi,j as l,S as Hi,C as Ot,P as Wi,L as $i,F as _i,h as Ki,M as Xi,i as qi,k as Dt,t as Yi,l as Ji,m as Qi,o as At}from"./index-BUG7berd.js";import{A as Nt}from"./arrow-left-BGn11AE0.js";import{C as Zi}from"./circle-check-big-Bo-cofWK.js";var Ue=typeof self<"u"?self:global;const xe=typeof navigator<"u",es=xe&&typeof HTMLImageElement>"u",Ne=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Ee=Ue.Buffer,Te=Ue.BigInt,je=!!Ee,ts=r=>r;function Me(r,e=ts){if(Ne)try{return typeof require=="function"?Promise.resolve(e(require(r))):import(r).then(e)}catch{console.warn(`Couldn't load ${r}`)}}let nt=Ue.fetch;const is=r=>nt=r;if(!Ue.fetch){const r=Me("http",(i=>i)),e=Me("https",(i=>i)),t=(i,{headers:s}={})=>new Promise((async(n,o)=>{let{port:c,hostname:u,pathname:p,protocol:d,search:m}=new URL(i);const y={method:"GET",hostname:u,path:encodeURI(p)+m,headers:s};c!==""&&(y.port=Number(c));const T=(d==="https:"?await e:await r).request(y,(D=>{if(D.statusCode===301||D.statusCode===302){let K=new URL(D.headers.location,i).toString();return t(K,{headers:s}).then(n).catch(o)}n({status:D.statusCode,arrayBuffer:()=>new Promise((K=>{let ne=[];D.on("data",(ze=>ne.push(ze))),D.on("end",(()=>K(Buffer.concat(ne))))}))})}));T.on("error",o),T.end()}));is(t)}function f(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const Le=r=>ei(r)?void 0:r,ss=r=>r!==void 0;function ei(r){return r===void 0||(r instanceof Map?r.size===0:Object.values(r).filter(ss).length===0)}function w(r){let e=new Error(r);throw delete e.stack,e}function J(r){return(r=(function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e})(r).trim())===""?void 0:r}function et(r){let e=(function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048})(r);return r.jfif.enabled&&(e+=50),r.xmp.enabled&&(e+=2e4),r.iptc.enabled&&(e+=14e3),r.icc.enabled&&(e+=6e3),e}const tt=r=>String.fromCharCode.apply(null,r),Mt=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function ti(r){return Mt?Mt.decode(r):je?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(tt(r)))}class O{static from(e,t){return e instanceof this&&e.le===t?e:new O(e,void 0,void 0,t)}constructor(e,t=0,i,s){if(typeof s=="boolean"&&(this.le=s),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let n=new DataView(e,t,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof O){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&w("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,i);this._swapDataView(n)}else if(typeof e=="number"){let n=new DataView(new ArrayBuffer(e));this._swapDataView(n)}else w("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=O){return e instanceof DataView||e instanceof O?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||w("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new O(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return ti(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return tt(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let s=0;s<t&&e+s<this.byteLength;s+=2)i.push(this.getUint16(e+s));return tt(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function it(r,e){w(`${r} '${e}' was not loaded, try using full build of exifr.`)}class at extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||it(this.kind,e),t&&(e in t||(function(i,s){w(`Unknown ${i} '${s}'.`)})(this.kind,e),t[e].enabled||it(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var R=new at("file parser"),C=new at("segment parser"),U=new at("file reader");function rs(r,e){return typeof r=="string"?Lt(r,e):xe&&!es&&r instanceof HTMLImageElement?Lt(r.src,e):r instanceof Uint8Array||r instanceof ArrayBuffer||r instanceof DataView?new O(r):xe&&r instanceof Blob?st(r,e,"blob",te):void w("Invalid input argument")}function Lt(r,e){return(t=r).startsWith("data:")||t.length>1e4?rt(r,e,"base64"):Ne&&r.includes("://")?st(r,e,"url",ee):Ne?rt(r,e,"fs"):xe?st(r,e,"url",ee):void w("Invalid input argument");var t}async function st(r,e,t,i){return U.has(t)?rt(r,e,t):i?(async function(s,n){let o=await n(s);return new O(o)})(r,i):void w(`Parser ${t} is not loaded`)}async function rt(r,e,t){let i=new(U.get(t))(r,e);return await i.read(),i}const ee=r=>nt(r).then((e=>e.arrayBuffer())),te=r=>new Promise(((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(r)}));class ns extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function S(r,e,t){let i=new ns;for(let[s,n]of t)i.set(s,n);if(Array.isArray(e))for(let s of e)r.set(s,i);else r.set(e,i);return i}function ie(r,e,t){let i,s=r.get(e);for(i of t)s.set(i[0],i[1])}const k=new Map,F=new Map,$=new Map,V=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],he=["jfif","xmp","icc","iptc","ihdr"],se=["tiff",...he],x=["ifd0","ifd1","exif","gps","interop"],z=[...se,...x],H=["makerNote","userComment"],de=["translateKeys","translateValues","reviveValues","multiSegment"],W=[...de,"sanitize","mergeOutput","silentErrors"];class ii{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class me extends ii{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,s){if(super(),f(this,"enabled",!1),f(this,"skip",new Set),f(this,"pick",new Set),f(this,"deps",new Set),f(this,"translateKeys",!1),f(this,"translateValues",!1),f(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(s),this.canBeFiltered=x.includes(e),this.canBeFiltered&&(this.dict=k.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:n,skip:o}=i;n&&n.length>0&&this.translateTagSet(n,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:w(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of de)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,s,{tagKeys:n,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(s=o.indexOf(i),s===-1&&(s=n.indexOf(Number(i))),s!==-1&&t.add(Number(n[s]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Fe(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Fe(this.pick,this.deps)}}var I={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Ft=new Map;class re extends ii{static useCached(e){let t=Ft.get(e);return t!==void 0||(t=new this(e),Ft.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):w(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=xe?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of V)this[e]=I[e];for(e of W)this[e]=I[e];for(e of H)this[e]=I[e];for(e of z)this[e]=new me(e,I[e],void 0,this)}setupFromTrue(){let e;for(e of V)this[e]=I[e];for(e of W)this[e]=I[e];for(e of H)this[e]=!0;for(e of z)this[e]=new me(e,!0,void 0,this)}setupFromArray(e){let t;for(t of V)this[t]=I[t];for(t of W)this[t]=I[t];for(t of H)this[t]=I[t];for(t of z)this[t]=new me(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,x)}setupFromObject(e){let t;for(t of(x.ifd0=x.ifd0||x.image,x.ifd1=x.ifd1||x.thumbnail,Object.assign(this,e),V))this[t]=Ke(e[t],I[t]);for(t of W)this[t]=Ke(e[t],I[t]);for(t of H)this[t]=Ke(e[t],I[t]);for(t of se)this[t]=new me(t,I[t],e[t],this);for(t of x)this[t]=new me(t,I[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,x,z),e.tiff===!0?this.batchEnableWithBool(x,!0):e.tiff===!1?this.batchEnableWithUserValue(x,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,x):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,x)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let s=t[i];this[i].enabled=s!==!1&&s!==void 0}}setupGlobalFilters(e,t,i,s=i){if(e&&e.length){for(let o of s)this[o].enabled=!1;let n=Rt(e,i);for(let[o,c]of n)Fe(this[o].pick,c),this[o].enabled=!0}else if(t&&t.length){let n=Rt(t,i);for(let[o,c]of n)Fe(this[o].skip,c)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:s,icc:n}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),s.enabled||e.skip.add(33723),n.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:s}=this;s.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=x.some((n=>this[n].enabled===!0))||this.makerNote||this.userComment;for(let n of x)this[n].finalizeFilters()}get onlyTiff(){return!he.map((e=>this[e].enabled)).some((e=>e===!0))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of se)this[e].enabled&&!C.has(e)&&it("segment parser",e)}}function Rt(r,e){let t,i,s,n,o=[];for(s of e){for(n of(t=k.get(s),i=[],t))(r.includes(n[0])||r.includes(n[1]))&&i.push(n[0]);i.length&&o.push([s,i])}return o}function Ke(r,e){return r!==void 0?r:e!==void 0?e:void 0}function Fe(r,e){for(let t of e)r.add(t)}f(re,"default",I);class _{constructor(e){f(this,"parsers",{}),f(this,"output",{}),f(this,"errors",[]),f(this,"pushToErrors",(t=>this.errors.push(t))),this.options=re.useCached(e)}async read(e){this.file=await rs(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,s]of R)if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),w("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Le(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async i=>{let s=await i.parse();i.assignToOutput(e,s)}));this.options.silentErrors&&(t=t.map((i=>i.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=C.get("tiff",e);var s;if(t.tiff?s={start:0,type:"tiff"}:t.jpeg&&(s=await this.fileParser.getOrFindSegment("tiff")),s===void 0)return;let n=await this.fileParser.ensureSegmentChunk(s),o=this.parsers.tiff=new i(n,e,t),c=await o.extractThumbnail();return t.close&&t.close(),c}}async function Be(r,e){let t=new _(e);return await t.read(r),t.parse()}var as=Object.freeze({__proto__:null,parse:Be,Exifr:_,fileParsers:R,segmentParsers:C,fileReaders:U,tagKeys:k,tagValues:F,tagRevivers:$,createDictionary:S,extendDictionary:ie,fetchUrlAsArrayBuffer:ee,readBlobAsArrayBuffer:te,chunkedProps:V,otherSegments:he,segments:se,tiffBlocks:x,segmentsAndBlocks:z,tiffExtractables:H,inheritables:de,allFormatters:W,Options:re});class Ge{constructor(e,t,i){f(this,"errors",[]),f(this,"ensureSegmentChunk",(async s=>{let n=s.start,o=s.size||65536;if(this.file.chunked)if(this.file.available(n,o))s.chunk=this.file.subarray(n,o);else try{s.chunk=await this.file.readChunk(n,o)}catch(c){w(`Couldn't read segment: ${JSON.stringify(s)}. ${c.message}`)}else this.file.byteLength>n+o?s.chunk=this.file.subarray(n,o):s.size===void 0?s.chunk=this.file.subarray(n):w("Segment unreachable: "+JSON.stringify(s));return s.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(C.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:s}=t,n=this.options[i];if(n&&n.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,s)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class L{static findPosition(e,t){let i=e.getUint16(t+2)+2,s=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,n=t+s,o=i-s;return{offset:t,length:i,headerLength:s,start:n,size:o,end:n+o}}static parse(e,t={}){return new this(e,new re({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof O?e:new O(e)}constructor(e,t={},i){f(this,"errors",[]),f(this,"raw",new Map),f(this,"handleError",(s=>{if(!this.options.silentErrors)throw s;this.errors.push(s.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=$.get(t),s=F.get(t),n=k.get(t),o=this.options[t],c=o.reviveValues&&!!i,u=o.translateValues&&!!s,p=o.translateKeys&&!!n,d={};for(let[m,y]of e)c&&i.has(m)?y=i.get(m)(y):u&&s.has(m)&&(y=this.translateValue(y,s.get(m))),p&&n.has(m)&&(m=n.get(m)||m),d[m]=y;return d}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}f(L,"headerLength",4),f(L,"type",void 0),f(L,"multiSegment",!1),f(L,"canHandle",(()=>!1));function os(r){return r===192||r===194||r===196||r===219||r===221||r===218||r===254}function ls(r){return r>=224&&r<=239}function cs(r,e,t){for(let[i,s]of C)if(s.canHandle(r,e,t))return i}class Ut extends Ge{constructor(...e){super(...e),f(this,"appSegments",[]),f(this,"jpegSegments",[]),f(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(C.keyList())):(e=e===void 0?C.keyList().filter((t=>this.options[t].enabled)):e.filter((t=>this.options[t].enabled&&C.has(t))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:s,wanted:n,remaining:o}=this;if(!s&&this.file.chunked&&(s=Array.from(n).some((c=>{let u=C.get(c),p=this.options[c];return u.multiSegment&&p.multiSegment})),s&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let c=!1;for(;o.size>0&&!c&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:u}=i,p=this.appSegments.some((d=>!this.file.available(d.offset||d.start,d.length||d.size)));if(c=e>u&&!p?!await i.readNextChunk(e):!await i.readNextChunk(u),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,s,n,o,c,u,{file:p,findAll:d,wanted:m,remaining:y,options:T}=this;for(;e<t;e++)if(p.getUint8(e)===255){if(i=p.getUint8(e+1),ls(i)){if(s=p.getUint16(e+2),n=cs(p,e,s),n&&m.has(n)&&(o=C.get(n),c=o.findPosition(p,e),u=T[n],c.type=n,this.appSegments.push(c),!d&&(o.multiSegment&&u.multiSegment?(this.unfinishedMultiSegment=c.chunkNumber<c.chunkCount,this.unfinishedMultiSegment||y.delete(n)):y.delete(n),y.size===0)))break;T.recordUnknownSegments&&(c=L.findPosition(p,e),c.marker=i,this.unknownSegments.push(c)),e+=s+1}else if(os(i)){if(s=p.getUint16(e+2),i===218&&T.stopAfterSos!==!1)return;T.recordJpegSegments&&this.jpegSegments.push({offset:e,length:s,marker:i}),e+=s+1}}return e}mergeMultiSegments(){if(!this.appSegments.some((t=>t.multiSegment)))return;let e=(function(t,i){let s,n,o,c=new Map;for(let u=0;u<t.length;u++)s=t[u],n=s[i],c.has(n)?o=c.get(n):c.set(n,o=[]),o.push(s);return Array.from(c)})(this.appSegments,"type");this.mergedAppSegments=e.map((([t,i])=>{let s=C.get(t,this.options);return s.handleMultiSegments?{type:t,chunk:s.handleMultiSegments(i)}:i[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}f(Ut,"type","jpeg"),R.set("jpeg",Ut);const us=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class hs extends L{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:s,skip:n}=this.options[t];s=new Set(s);let o=s.size>0,c=n.size===0,u=this.chunk.getUint16(e);e+=2;for(let p=0;p<u;p++){let d=this.chunk.getUint16(e);if(o){if(s.has(d)&&(i.set(d,this.parseTag(e,d,t)),s.delete(d),s.size===0))break}else!c&&n.has(d)||i.set(d,this.parseTag(e,d,t));e+=12}return i}parseTag(e,t,i){let{chunk:s}=this,n=s.getUint16(e+2),o=s.getUint32(e+4),c=us[n];if(c*o<=4?e+=8:e=s.getUint32(e+8),(n<1||n>13)&&w(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e}`),e>s.byteLength&&w(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e} is outside of chunk size ${s.byteLength}`),n===1)return s.getUint8Array(e,o);if(n===2)return J(s.getString(e,o));if(n===7)return s.getUint8Array(e,o);if(o===1)return this.parseTagValue(n,e);{let u=new((function(d){switch(d){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(n))(o),p=c;for(let d=0;d<o;d++)u[d]=this.parseTagValue(n,e),e+=p;return u}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:w(`Invalid tiff type ${e}`)}}}class Xe extends hs{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&w("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&w(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,et(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,et(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",Et(...e.get(2),e.get(1))),e.set("longitude",Et(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,s={};for(t of x)if(e=this[t],!ei(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(s,i)}else s[t]=i;return this.makerNote&&(s.makerNote=this.makerNote),this.userComment&&(s.userComment=this.userComment),s}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,s]of Object.entries(t))this.assignObjectToOutput(e,i,s)}}function Et(r,e,t,i){var s=r+e/60+t/3600;return i!=="S"&&i!=="W"||(s*=-1),s}f(Xe,"type","tiff"),f(Xe,"headerLength",10),C.set("tiff",Xe);var ds=Object.freeze({__proto__:null,default:as,Exifr:_,fileParsers:R,segmentParsers:C,fileReaders:U,tagKeys:k,tagValues:F,tagRevivers:$,createDictionary:S,extendDictionary:ie,fetchUrlAsArrayBuffer:ee,readBlobAsArrayBuffer:te,chunkedProps:V,otherSegments:he,segments:se,tiffBlocks:x,segmentsAndBlocks:z,tiffExtractables:H,inheritables:de,allFormatters:W,Options:re,parse:Be});const ot={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},lt=Object.assign({},ot,{firstChunkSize:4e4,gps:[1,2,3,4]});async function si(r){let e=new _(lt);await e.read(r);let t=await e.parse();if(t&&t.gps){let{latitude:i,longitude:s}=t.gps;return{latitude:i,longitude:s}}}const ct=Object.assign({},ot,{tiff:!1,ifd1:!0,mergeOutput:!1});async function ri(r){let e=new _(ct);await e.read(r);let t=await e.extractThumbnail();return t&&je?Ee.from(t):t}async function ni(r){let e=await this.thumbnail(r);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}const ut=Object.assign({},ot,{firstChunkSize:4e4,ifd0:[274]});async function ht(r){let e=new _(ut);await e.read(r);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const dt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Q=!0,Z=!0;if(typeof navigator=="object"){let r=navigator.userAgent;if(r.includes("iPad")||r.includes("iPhone")){let e=r.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;Q=Number(t)+.1*Number(i)<13.4,Z=!1}}else if(r.includes("OS X 10")){let[,e]=r.match(/OS X 10[_.](\d+)/);Q=Z=Number(e)<15}if(r.includes("Chrome/")){let[,e]=r.match(/Chrome\/(\d+)/);Q=Z=Number(e)<81}else if(r.includes("Firefox/")){let[,e]=r.match(/Firefox\/(\d+)/);Q=Z=Number(e)<77}}async function ai(r){let e=await ht(r);return Object.assign({canvas:Q,css:Z},dt[e])}class fs extends O{constructor(...e){super(...e),f(this,"ranges",new ps),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let s=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(s)}else{let s=e+t;if(s>this.byteLength){let{dataView:n}=this._extend(s);this._swapDataView(n)}}}_extend(e){let t;t=je?Ee.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let s=super.set(e,t);return this.ranges.add(t,s.byteLength),s}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class ps{constructor(){f(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let s=e+t,n=this.list.filter((o=>jt(e,o.offset,s)||jt(e,o.end,s)));if(n.length>0){e=Math.min(e,...n.map((c=>c.offset))),s=Math.max(s,...n.map((c=>c.end))),t=s-e;let o=n.shift();o.offset=e,o.length=t,o.end=s,this.list=this.list.filter((c=>!n.includes(c)))}else this.list.push({offset:e,length:t,end:s})}available(e,t){let i=e+t;return this.list.some((s=>s.offset<=e&&i<=s.end))}}function jt(r,e,t){return r<=e&&e<=t}class Ve extends fs{constructor(e,t){super(0),f(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}U.set("blob",class extends Ve{async readWhole(){this.chunked=!1;let r=await te(this.input);this._swapArrayBuffer(r)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(r,e){let t=e?r+e:void 0,i=this.input.slice(r,t),s=await te(i);return this.set(s,r,!0)}});var gs=Object.freeze({__proto__:null,default:ds,Exifr:_,fileParsers:R,segmentParsers:C,fileReaders:U,tagKeys:k,tagValues:F,tagRevivers:$,createDictionary:S,extendDictionary:ie,fetchUrlAsArrayBuffer:ee,readBlobAsArrayBuffer:te,chunkedProps:V,otherSegments:he,segments:se,tiffBlocks:x,segmentsAndBlocks:z,tiffExtractables:H,inheritables:de,allFormatters:W,Options:re,parse:Be,gpsOnlyOptions:lt,gps:si,thumbnailOnlyOptions:ct,thumbnail:ri,thumbnailUrl:ni,orientationOnlyOptions:ut,orientation:ht,rotations:dt,get rotateCanvas(){return Q},get rotateCss(){return Z},rotation:ai});U.set("url",class extends Ve{async readWhole(){this.chunked=!1;let r=await ee(this.input);r instanceof ArrayBuffer?this._swapArrayBuffer(r):r instanceof Uint8Array&&this._swapBuffer(r)}async _readChunk(r,e){let t=e?r+e-1:void 0,i=this.options.httpHeaders||{};(r||t)&&(i.range=`bytes=${[r,t].join("-")}`);let s=await nt(this.input,{headers:i}),n=await s.arrayBuffer(),o=n.byteLength;if(s.status!==416)return o!==e&&(this.size=r+o),this.set(n,r,!0)}});O.prototype.getUint64=function(r){let e=this.getUint32(r),t=this.getUint32(r+4);return e<1048575?e<<32|t:typeof Te!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),Te(e)<<Te(32)|Te(t)):void w("Trying to read 64b value but JS can only handle 53b numbers.")};class ms extends Ge{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find((i=>i.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),s=e+8;return t===1&&(t=this.file.getUint64(e+8),s+=8),{offset:e,length:t,kind:i,start:s}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class oi extends ms{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let s=16,n=[];for(;s<i;)n.push(e.getString(s,4)),s+=4;return n.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let s=this.file.subarray(t,i);this.createParser(e,s)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let s=this.findBox(i,"colr");s!==void 0&&await this.registerSegment("icc",s.offset+12,s.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let s=this.findExifLocIdInIinf(t),n=this.findExtentInIloc(i,s);if(n===void 0)return;let[o,c]=n;await this.file.ensureChunk(o,c);let u=4+this.file.getUint32(o);o+=u,c-=u,await this.registerSegment("tiff",o,c)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,s,n,o=e.start,c=this.file.getUint16(o);for(o+=2;c--;){if(t=this.parseBoxHead(o),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(s=t.version===3?4:2,n=this.file.getString(i+s+2,4),n==="Exif"))return this.file.getUintBytes(i,s);o+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[s,n]=this.get8bits(i++),[o,c]=this.get8bits(i++),u=e.version===2?4:2,p=e.version===1||e.version===2?2:0,d=c+s+n,m=e.version===2?4:2,y=this.file.getUintBytes(i,m);for(i+=m;y--;){let T=this.file.getUintBytes(i,u);i+=u+p+2+o;let D=this.file.getUint16(i);if(i+=2,T===t)return D>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+c,s),this.file.getUintBytes(i+c+s,n)];i+=D*d}}}class li extends oi{}f(li,"type","heic");class Bt extends oi{}f(Bt,"type","avif"),R.set("heic",li),R.set("avif",Bt),S(k,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),S(k,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),S(k,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),S(F,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let be=S(F,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Gt={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};be.set(37392,Gt),be.set(41488,Gt);const qe={0:"Normal",1:"Low",2:"High"};function Vt(r){return typeof r=="object"&&r.length!==void 0?r[0]:r}function zt(r){let e=Array.from(r).slice(1);return e[1]>15&&(e=e.map((t=>String.fromCharCode(t)))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function Ye(r){if(typeof r=="string"){var[e,t,i,s,n,o]=r.trim().split(/[-: ]/g).map(Number),c=new Date(e,t-1,i);return Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(o)||(c.setHours(s),c.setMinutes(n),c.setSeconds(o)),Number.isNaN(+c)?r:c}}function ye(r){if(typeof r=="string")return r;let e=[];if(r[1]===0&&r[r.length-1]===0)for(let t=0;t<r.length;t+=2)e.push(Ht(r[t+1],r[t]));else for(let t=0;t<r.length;t+=2)e.push(Ht(r[t],r[t+1]));return J(String.fromCodePoint(...e))}function Ht(r,e){return r<<8|e}be.set(41992,qe),be.set(41993,qe),be.set(41994,qe),S($,["ifd0","ifd1"],[[50827,function(r){return typeof r!="string"?ti(r):r}],[306,Ye],[40091,ye],[40092,ye],[40093,ye],[40094,ye],[40095,ye]]),S($,"exif",[[40960,zt],[36864,zt],[36867,Ye],[36868,Ye],[40962,Vt],[40963,Vt]]),S($,"gps",[[0,r=>Array.from(r).join(".")],[7,r=>Array.from(r).join(":")]]);class Je extends L{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:33}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((t=>t.chunk.getString())).join("")}normalizeInput(e){return typeof e=="string"?e:O.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=(function(n){let o={},c={};for(let u of di)o[u]=[],c[u]=0;return n.replace(Ss,((u,p,d)=>{if(p==="<"){let m=++c[d];return o[d].push(m),`${u}#${m}`}return`${u}#${o[d].pop()}`}))})(e);let t=ue.findAll(e,"rdf","Description");t.length===0&&t.push(new ue("rdf","Description",void 0,e));let i,s={};for(let n of t)for(let o of n.properties)i=xs(o.ns,s),ci(o,i);return(function(n){let o;for(let c in n)o=n[c]=Le(n[c]),o===void 0&&delete n[c];return Le(n)})(s)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,s]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",s);break;case"exif":this.assignObjectToOutput(e,"exif",s);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,s)}else e.xmp=t}}f(Je,"type","xmp"),f(Je,"multiSegment",!0),C.set("xmp",Je);class Re{static findAll(e){return ui(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Re.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],s=e[3].slice(1,-1);return s=hi(s),new Re(t,i,s)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class ue{static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var s=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else s=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return ui(e,s).map(ue.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],s=e[4],n=e[8];return new ue(t,i,s,n)}constructor(e,t,i,s){this.ns=e,this.name=t,this.attrString=i,this.innerXml=s,this.attrs=Re.findAll(i),this.children=ue.findAll(s),this.value=this.children.length===0?hi(s):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return bs(this.children.map(ys));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)ci(t,e);return this.value!==void 0&&(e.value=this.value),Le(e)}}function ci(r,e){let t=r.serialize();t!==void 0&&(e[r.name]=t)}var ys=r=>r.serialize(),bs=r=>r.length===1?r[0]:r,xs=(r,e)=>e[r]?e[r]:e[r]={};function ui(r,e){let t,i=[];if(!r)return i;for(;(t=e.exec(r))!==null;)i.push(t);return i}function hi(r){if((function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""})(r))return;let e=Number(r);if(!Number.isNaN(e))return e;let t=r.toLowerCase();return t==="true"||t!=="false"&&r.trim()}const di=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Ss=new RegExp(`(<|\\/)(${di.join("|")})`,"g");var Wt=Object.freeze({__proto__:null,default:gs,Exifr:_,fileParsers:R,segmentParsers:C,fileReaders:U,tagKeys:k,tagValues:F,tagRevivers:$,createDictionary:S,extendDictionary:ie,fetchUrlAsArrayBuffer:ee,readBlobAsArrayBuffer:te,chunkedProps:V,otherSegments:he,segments:se,tiffBlocks:x,segmentsAndBlocks:z,tiffExtractables:H,inheritables:de,allFormatters:W,Options:re,parse:Be,gpsOnlyOptions:lt,gps:si,thumbnailOnlyOptions:ct,thumbnail:ri,thumbnailUrl:ni,orientationOnlyOptions:ut,orientation:ht,rotations:dt,get rotateCanvas(){return Q},get rotateCss(){return Z},rotation:ai});let $t=Me("fs",(r=>r.promises));U.set("fs",class extends Ve{async readWhole(){this.chunked=!1,this.fs=await $t;let r=await this.fs.readFile(this.input);this._swapBuffer(r)}async readChunked(){this.chunked=!0,this.fs=await $t,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(r,e){this.fh===void 0&&await this.open(),r+e>this.size&&(e=this.size-r);var t=this.subarray(r,e,!0);return await this.fh.read(t.dataView,0,e,r),t}async close(){if(this.fh){let r=this.fh;this.fh=void 0,await r.close()}}});U.set("base64",class extends Ve{constructor(...r){super(...r),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(r,e){let t,i,s=this.input;r===void 0?(r=0,t=0,i=0):(t=4*Math.floor(r/3),i=r-t/4*3),e===void 0&&(e=this.size);let n=r+e,o=t+4*Math.ceil(n/3);s=s.slice(t,o);let c=Math.min(e,this.size-r);if(je){let u=Ee.from(s,"base64").slice(i,i+c);return this.set(u,r,!0)}{let u=this.subarray(r,c,!0),p=atob(s),d=u.toUint8();for(let m=0;m<c;m++)d[m]=p.charCodeAt(i+m);return u}}});class _t extends Ge{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:s,icc:n}=e;i.enabled&&t.deps.add(700),s.enabled&&t.deps.add(33723),n.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:s}=this.options;if(e.enabled||t.enabled||i.enabled||s.enabled){let n=Math.max(et(this.options),this.options.chunkSize);await this.file.ensureChunk(0,n),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}f(_t,"type","tiff"),R.set("tiff",_t);let Cs=Me("zlib");const ws=["ihdr","iccp","text","itxt","exif"];class Kt extends Ge{constructor(...e){super(...e),f(this,"catchError",(t=>this.errors.push(t))),f(this,"metaChunks",[]),f(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let s=i.getUint32(e),n=i.getUint32(e+4),o=i.getString(e+4,4).toLowerCase(),c=s+4+4+4,u={type:o,offset:e,length:c,start:e+4+4,size:s,marker:n};ws.includes(o)?this.metaChunks.push(u):this.unknownChunks.push(u),e+=c}}parseTextChunks(){let e=this.metaChunks.filter((t=>t.type==="text"));for(let t of e){let[i,s]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,s)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find((t=>t.type==="ihdr"));e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find((t=>t.type==="exif"));e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter((t=>t.type==="itxt"));for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find((c=>c.type==="iccp"));if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),s=0;for(;s<80&&i[s]!==0;)s++;let n=s+2,o=t.getString(0,s);if(this.injectKeyValToIhdr("ProfileName",o),Ne){let c=await Cs,u=t.getUint8Array(n);u=c.inflateSync(u),this.injectSegment("icc",u)}}}f(Kt,"type","png"),R.set("png",Kt),S(k,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),ie(k,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let Xt=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];ie(k,"ifd0",Xt),ie(k,"exif",Xt),S(F,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Qe extends L{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}f(Qe,"type","jfif"),f(Qe,"headerLength",9),C.set("jfif",Qe),S(k,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class qt extends L{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}f(qt,"type","ihdr"),C.set("ihdr",qt),S(k,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),S(F,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class Ae extends L{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return(function(t){let i=(function(s){let n=s[0].constructor,o=0;for(let p of s)o+=p.length;let c=new n(o),u=0;for(let p of s)c.set(p,u),u+=p.length;return c})(t.map((s=>s.chunk.toUint8())));return new O(i)})(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&w("ICC header is too short");for(let[t,i]of Object.entries(vs)){t=parseInt(t,10);let s=i(this.chunk,t);s!=="\0\0\0\0"&&e.set(t,s)}}parseTags(){let e,t,i,s,n,{raw:o}=this,c=this.chunk.getUint32(128),u=132,p=this.chunk.byteLength;for(;c--;){if(e=this.chunk.getString(u,4),t=this.chunk.getUint32(u+4),i=this.chunk.getUint32(u+8),s=this.chunk.getString(t,4),t+i>p)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");n=this.parseTag(s,t,i),n!==void 0&&n!=="\0\0\0\0"&&o.set(e,n),u+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return J(this.chunk.getString(e+12,t))}parseText(e,t){return J(this.chunk.getString(e+8,t-8))}parseSig(e){return J(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),s=t.getUint32(e+12),n=e+16,o=[];for(let c=0;c<i;c++){let u=t.getString(n+0,2),p=t.getString(n+2,2),d=t.getUint32(n+4),m=t.getUint32(n+8)+e,y=J(t.getUnicodeString(m,d));o.push({lang:u,country:p,text:y}),n+=s}return i===1?o[0].text:o}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}f(Ae,"type","icc"),f(Ae,"multiSegment",!0),f(Ae,"headerLength",18);const vs={4:j,8:function(r,e){return[r.getUint8(e),r.getUint8(e+1)>>4,r.getUint8(e+1)%16].map((t=>t.toString(10))).join(".")},12:j,16:j,20:j,24:function(r,e){const t=r.getUint16(e),i=r.getUint16(e+2)-1,s=r.getUint16(e+4),n=r.getUint16(e+6),o=r.getUint16(e+8),c=r.getUint16(e+10);return new Date(Date.UTC(t,i,s,n,o,c))},36:j,40:j,48:j,52:j,64:(r,e)=>r.getUint32(e),80:j};function j(r,e){return J(r.getString(e,4))}C.set("icc",Ae),S(k,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Pe={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Yt={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};S(F,"icc",[[4,Pe],[12,Yt],[40,Object.assign({},Pe,Yt)],[48,Pe],[80,Pe],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class Oe extends L{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let s,n=this.containsIptc8bim(e,t,i);if(n!==void 0)return s=e.getUint8(t+n+7),s%2!=0&&(s+=1),s===0&&(s=4),n+8+s}static containsIptc8bim(e,t,i){for(let s=0;s<i;s++)if(this.isIptcSegmentHead(e,t+s))return s}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let s=0;s<t;s++)if(this.chunk.getUint8(s)===28&&this.chunk.getUint8(s+1)===2){i=!0;let n=this.chunk.getUint16(s+3),o=this.chunk.getUint8(s+2),c=this.chunk.getLatin1String(s+5,n);e.set(o,this.pluralizeValue(e.get(o),c)),s+=4+n}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}f(Oe,"type","iptc"),f(Oe,"translateValues",!1),f(Oe,"reviveValues",!1),C.set("iptc",Oe),S(k,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),S(F,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);const De=["MTN","Orange","Airtel"],ks=["Cash","Mobile Money","Card"],Ze=["Super","Diesel","Gas"],Is=["08:00 - 20:00","09:00 - 19:00","24/7"],Ts=8*1024*1024,Jt=1600,Ps=.72,Os=.82,Ds=new Set(["image/jpeg","image/jpg"]);function As(r){const e=r.indexOf(",");if(e===-1)return null;const t=r.slice(e+1);if(!t)return null;const i=atob(t),s=new Uint8Array(i.length);for(let n=0;n<i.length;n+=1)s[n]=i.charCodeAt(n);return s}function Ns(r,e){let t="";for(let i=0;i<r.length;i+=1)t+=String.fromCharCode(r[i]??0);return`data:${e};base64,${btoa(t)}`}function Qt(r){if(r.length<4||r[0]!==255||r[1]!==216)return null;let e=2;for(;e+4<=r.length;){if(r[e]!==255){e+=1;continue}const t=r[e+1];if(t===216||t===1||t>=208&&t<=215){e+=2;continue}if(t===218||t===217)break;const i=(r[e+2]??0)<<8|(r[e+3]??0);if(i<2)break;const s=e+2+i;if(s>r.length)break;if(t===225&&i>=8&&String.fromCharCode(r[e+4]??0,r[e+5]??0,r[e+6]??0,r[e+7]??0,r[e+8]??0,r[e+9]??0)==="Exif\0\0")return r.slice(e,s);e=s}return null}function Ms(r,e){if(r.length<2||r[0]!==255||r[1]!==216||!e.length)return null;const t=new Uint8Array(r.length+e.length);return t[0]=r[0],t[1]=r[1],t.set(e,2),t.set(r.slice(2),2+e.length),t}async function Ls(r,e){if(!Ds.has((r.type||"").toLowerCase()))return e;const t=new Uint8Array(await r.arrayBuffer()),i=Qt(t);if(!i)return e;const s=As(e);if(!s||Qt(s))return e;const n=Ms(s,i);return n?Ns(n,"image/jpeg"):e}async function Fs(r){try{const[e,t]=await Promise.all([Wt.parse(r,{gps:!0,exif:!0,tiff:!0,pick:["latitude","longitude","GPSLatitude","GPSLongitude","DateTimeOriginal","DateTimeDigitized","CreateDate","ModifyDate","Make","Model"]}).catch(()=>null),Wt.gps(r).catch(()=>null)]),i={...e??{},...t??{}},s=typeof i.latitude=="number"?i.latitude:null,n=typeof i.longitude=="number"?i.longitude:null,o=i.DateTimeOriginal??i.DateTimeDigitized??i.CreateDate??i.ModifyDate;let c=null;if(o instanceof Date)c=o.toISOString();else if(typeof o=="string"&&o.trim()){const d=o.match(/^(\d{4}):(\d{2}):(\d{2})\s+(\d{2}):(\d{2}):(\d{2})/);c=d?`${d[1]}-${d[2]}-${d[3]}T${d[4]}:${d[5]}:${d[6]}`:o}const u=typeof i.Make=="string"?i.Make:null,p=typeof i.Model=="string"?i.Model:null;return s==null&&n==null&&!c&&!u&&!p?null:{latitude:s,longitude:n,capturedAt:c,deviceMake:u,deviceModel:p}}catch{return null}}const Zt=r=>r===Ot.PHARMACY?"pharmacy":r===Ot.FUEL?"fuel_station":"mobile_money",js=({onBack:r,onComplete:e,language:t,mode:i,seedPoint:s})=>{var It;const n=(a,h)=>t==="fr"?h:a,[o,c]=g.useState(()=>s?Zt(s.type):"pharmacy"),[u,p]=g.useState(null),[d,m]=g.useState(null),[y,T]=g.useState(null),[D,K]=g.useState(!1),[ne,ze]=g.useState(""),[He,fi]=g.useState(""),[ft,Se]=g.useState(""),[pt,fe]=g.useState(""),[gt,X]=g.useState(""),[Ce,B]=g.useState(""),[mt,yt]=g.useState(!1),[pi,gi]=g.useState(!1),[ae,bt]=g.useState((s==null?void 0:s.name)??""),[q,xt]=g.useState((s==null?void 0:s.openingHours)??""),[oe,St]=g.useState((s==null?void 0:s.isOpenNow)??!0),[We,mi]=g.useState((s==null?void 0:s.isOnDuty)??!1),[le,Ct]=g.useState((s==null?void 0:s.providers)??[]),[pe,yi]=g.useState((s==null?void 0:s.merchantId)??""),[$e,bi]=g.useState(((It=s==null?void 0:s.providers)==null?void 0:It[0])??De[0]),[Y,xi]=g.useState((s==null?void 0:s.paymentMethods)??[]),[ce,wt]=g.useState((s==null?void 0:s.hasFuelAvailable)??!0),[ge,Si]=g.useState((s==null?void 0:s.fuelTypes)??(s!=null&&s.fuelType?[s.fuelType]:[])),[_e,Ci]=g.useState((s==null?void 0:s.fuelType)??Ze[0]),[we,wi]=g.useState(s!=null&&s.price?String(s.price):""),[ve,vi]=g.useState((s==null?void 0:s.quality)??"Standard"),[ki]=g.useState(()=>zi()),A=g.useMemo(()=>(s==null?void 0:s.gaps)??[],[s]),E=i==="ENRICH"&&!!s,Ii=a=>{const b={openingHours:{en:"Opening Hours",fr:"Heures d'ouverture"},isOpenNow:{en:"Open Now Status",fr:"Statut ouvert maintenant"},isOnDuty:{en:"On-call Pharmacy",fr:"Pharmacie de garde"},merchantIdByProvider:{en:"Merchant IDs",fr:"ID marchands"},paymentMethods:{en:"Payment Methods",fr:"Moyens de paiement"},providers:{en:"Providers",fr:"Operateurs"},fuelTypes:{en:"Fuel Types",fr:"Types de carburant"},pricesByFuel:{en:"Fuel Prices",fr:"Prix carburant"},quality:{en:"Quality",fr:"Qualite"},hasFuelAvailable:{en:"Fuel Availability",fr:"Disponibilite carburant"}}[a];return b?t==="fr"?b.fr:b.en:a};g.useEffect(()=>{s&&c(Zt(s.type))},[s]),g.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>T({latitude:a.coords.latitude,longitude:a.coords.longitude}),()=>T(null),{enableHighAccuracy:!0,timeout:1e4})},[]),g.useEffect(()=>()=>{u&&URL.revokeObjectURL(u)},[u]),g.useEffect(()=>{const a=async()=>{await vt()};return window.addEventListener("online",a),()=>window.removeEventListener("online",a)},[]);const vt=async()=>{try{const a=await Ji(Qi);if(a.permanentFailures>0){const h=a.permanentFailureMessages[0]??n("Submission rejected by server validation.","Soumission rejetee par la validation serveur."),b=n(`${a.permanentFailures} queued item(s) were rejected: ${h}`,`${a.permanentFailures} element(s) en file ont ete rejetes : ${h}`);a.failed>0?B(`${b} ${n(`${a.failed} item(s) still pending sync.`,`${a.failed} element(s) en attente de synchronisation.`)}`):B(b)}else if(a.failed>0)B(n(`Saved offline. ${a.failed} item(s) still pending sync.`,`${a.failed} element(s) en attente de synchronisation.`));else if(a.synced>0)B(n("Saved offline and synced successfully.","Enregistre hors ligne puis synchronise avec succes."));else{const h=await Dt();h.total>0&&B(n(`${h.total} item(s) queued for sync.`,`${h.total} element(s) en file de synchronisation.`))}return a}catch(a){return B(a instanceof Error?a.message:n("Saved offline. Sync will retry automatically.","Enregistre hors ligne. La synchronisation reessaiera automatiquement.")),null}},Ti=()=>new Promise((a,h)=>{if(!navigator.geolocation){h(new Error(n("Geolocation not supported.","Geolocalisation non supportee.")));return}navigator.geolocation.getCurrentPosition(b=>a({latitude:b.coords.latitude,longitude:b.coords.longitude}),()=>h(new Error(n("Unable to access location.","Impossible d'acceder a la localisation."))),{enableHighAccuracy:!0,timeout:1e4})}),Pi=async()=>{fe("");try{const a=await Ti();T(a),K(!1)}catch{T(null),fe(n("Unable to access location. Use manual fallback coordinates.","Impossible d'acceder a la localisation. Utilisez les coordonnees manuelles.")),K(!0)}},kt=()=>{const a=ne.trim(),h=He.trim();if(!a&&!h)return null;const b=Number(a),N=Number(h);return!Number.isFinite(b)||!Number.isFinite(N)?null:{latitude:b,longitude:N}},Oi=a=>{var N;const h=(N=a.target.files)==null?void 0:N[0];if(!h)return;m(h),Se("");const b=URL.createObjectURL(h);p(P=>(P&&URL.revokeObjectURL(P),b))},Di=async a=>{const h=P=>new Promise((G,M)=>{const v=new FileReader;v.onload=()=>{if(typeof v.result=="string"){G(v.result);return}M(new Error("Unable to read file."))},v.onerror=()=>M(new Error("Unable to read file.")),v.readAsDataURL(P)});if(!a.type.startsWith("image/"))return await h(a);if(a.size<=Ts)return await h(a);const b=P=>new Promise((G,M)=>{const v=new Image;v.onload=()=>G(v),v.onerror=()=>M(new Error("Unable to decode image.")),v.src=P}),N=URL.createObjectURL(a);try{const P=await b(N),G=Math.max(P.width,P.height),M=G>Jt?Jt/G:1,v=Math.max(1,Math.round(P.width*M)),Tt=Math.max(1,Math.round(P.height*M)),Ie=document.createElement("canvas");Ie.width=v,Ie.height=Tt;const Pt=Ie.getContext("2d");if(!Pt)return await h(a);Pt.drawImage(P,0,0,v,Tt);const Gi=ki?Ps:Os,Vi=Ie.toDataURL("image/jpeg",Gi);return await Ls(a,Vi)}catch{return await h(a)}finally{URL.revokeObjectURL(N)}},ke=(a,h)=>a.includes(h)?a.filter(b=>b!==h):[...a,h],Ai=()=>{const a=At();if(o==="pharmacy")return{name:ae.trim(),isOpenNow:oe,openingHours:q.trim()||void 0,clientDevice:a};if(o==="mobile_money")return{providers:le,openingHours:q.trim()||void 0,paymentMethods:Y.length?Y:void 0,merchantIdByProvider:pe.trim()?{[$e]:pe.trim()}:void 0,clientDevice:a};const h=Number(we);return{name:ae.trim(),hasFuelAvailable:ce,fuelTypes:ge.length?ge:void 0,pricesByFuel:Number.isFinite(h)?{[_e]:h}:void 0,quality:ve,openingHours:q.trim()||void 0,paymentMethods:Y.length?Y:void 0,clientDevice:a}},Ni=()=>{const a={clientDevice:At()};for(const h of A)h==="openingHours"&&q.trim()&&(a.openingHours=q.trim()),h==="isOpenNow"&&(a.isOpenNow=oe),h==="isOnDuty"&&(a.isOnDuty=We),h==="providers"&&le.length&&(a.providers=le),h==="merchantIdByProvider"&&pe.trim()&&(a.merchantIdByProvider={[$e]:pe.trim()}),h==="paymentMethods"&&Y.length&&(a.paymentMethods=Y),h==="fuelTypes"&&ge.length&&(a.fuelTypes=ge),h==="pricesByFuel"&&Number.isFinite(Number(we))&&(a.pricesByFuel={[_e]:Number(we)}),h==="quality"&&ve&&(a.quality=ve),h==="hasFuelAvailable"&&(a.hasFuelAvailable=ce);return a},Mi=a=>{if(Se(""),fe(""),X(""),!d)return Se(n("Please capture a live photo before submitting.","Veuillez capturer une photo en direct avant de soumettre.")),!1;if(!y&&!kt())return fe(n("GPS is required. Retry location or enter fallback coordinates.","Le GPS est requis. Reessayez la localisation ou saisissez des coordonnees de secours.")),!1;if(E){if(Object.keys(a).filter(h=>h!=="clientDevice").length===0)return X(n("Fill at least one gap field to enrich this point.","Renseignez au moins un champ manquant pour enrichir ce point.")),!1}else{if(o==="pharmacy"&&!ae.trim())return X(n("Pharmacy name is required.","Le nom de la pharmacie est requis.")),!1;if(o==="mobile_money"&&le.length===0)return X(n("Select at least one provider.","Selectionnez au moins un operateur.")),!1;if(o==="fuel_station"&&!ae.trim())return X(n("Fuel station name is required.","Le nom de la station-service est requis.")),!1}return!0},Li=async()=>{if(!d){Se(n("Please capture a live photo before submitting.","Veuillez capturer une photo en direct avant de soumettre."));return}const a=kt();if((ne.trim()||He.trim())&&!a){fe(n("Enter a valid latitude and longitude.","Entrez une latitude et une longitude valides."));return}const h=E?Ni():Ai();if(Mi(h)){B(""),yt(!0);try{const[b,N]=await Promise.all([Di(d),Fs(d)]),P={eventType:E?"ENRICH_EVENT":"CREATE_EVENT",category:o,pointId:E&&s?s.id:void 0,location:y??a??void 0,details:h,imageBase64:b,clientExif:N},G=await qi(P);let M=null;if(navigator.onLine)M=await vt();else{const v=await Dt();B(n(`Saved offline. ${v.total} item(s) pending sync.`,`Enregistre hors ligne. ${v.total} element(s) en attente de synchronisation.`))}if(M&&M.permanentFailureIds.includes(G.id)){const v=M.permanentFailureMessages[0]??n("Submission rejected by server validation.","Soumission rejetee par la validation serveur.");X(v);return}gi(!0)}catch(b){const N=Yi(b);X(N.message||n("Submission failed.","Echec de la soumission."))}finally{yt(!1)}}},Fi=()=>E?null:l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-3",children:[l.jsx("h4",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:n("Vertical","Verticale")}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsx("button",{onClick:()=>c("pharmacy"),className:`h-11 rounded-xl border text-xs font-bold uppercase tracking-widest ${o==="pharmacy"?"bg-[#eaf3ee] border-[#2f855a] text-[#2f855a]":"border-gray-100 text-gray-500"}`,children:n("Pharmacy","Pharmacie")}),l.jsx("button",{onClick:()=>c("mobile_money"),className:`h-11 rounded-xl border text-xs font-bold uppercase tracking-widest ${o==="mobile_money"?"bg-[#e7eef4] border-[#0f2b46] text-[#0f2b46]":"border-gray-100 text-gray-500"}`,children:n("Kiosk","Kiosque")}),l.jsx("button",{onClick:()=>c("fuel_station"),className:`h-11 rounded-xl border text-xs font-bold uppercase tracking-widest ${o==="fuel_station"?"bg-[#f7e8e1] border-[#c86b4a] text-[#c86b4a]":"border-gray-100 text-gray-500"}`,children:n("Fuel","Carburant")})]})]}),Ri=()=>l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Xi,{size:16,className:"text-[#0f2b46]"}),l.jsx("span",{className:"text-xs font-bold text-gray-900",children:n("GPS Location","Localisation GPS")})]}),l.jsx("button",{onClick:Pi,className:"text-[10px] font-bold uppercase tracking-widest text-[#0f2b46]",children:n("Retry","Reessayer")})]}),l.jsx("p",{className:"text-[11px] text-gray-500",children:y?`GPS: ${y.latitude.toFixed(4)}, ${y.longitude.toFixed(4)}`:n("GPS unavailable. Retry, then use fallback if needed.","GPS indisponible. Reessayez, puis utilisez le secours si necessaire.")}),!y&&l.jsx("button",{onClick:()=>K(a=>!a),className:"text-[10px] font-bold uppercase tracking-widest text-[#c86b4a]",children:D?n("Hide Manual Fallback","Masquer secours manuel"):n("Use Manual Fallback","Utiliser secours manuel")}),D&&l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("input",{value:ne,onChange:a=>ze(a.target.value),placeholder:n("Latitude","Latitude"),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"}),l.jsx("input",{value:He,onChange:a=>fi(a.target.value),placeholder:n("Longitude","Longitude"),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"})]}),pt&&l.jsx("div",{className:"rounded-xl border border-red-100 bg-red-50 p-3 text-[10px] font-bold uppercase tracking-widest text-red-600",children:pt})]}),Ui=()=>l.jsxs("div",{className:"space-y-3",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900",children:n("Live Camera Proof","Preuve camera en direct")}),l.jsx("p",{className:"text-xs text-gray-500",children:n("Camera capture only. Gallery uploads are blocked.","Capture camera uniquement. Import galerie bloque.")}),l.jsxs("div",{className:"aspect-square w-full rounded-2xl bg-gray-50 border-2 border-dashed border-gray-200 flex flex-col items-center justify-center text-gray-400 relative overflow-hidden",children:[u?l.jsx("img",{src:u,alt:n("Captured photo","Photo capturee"),className:"absolute inset-0 h-full w-full object-cover"}):l.jsxs(l.Fragment,{children:[l.jsx(Ki,{size:46,className:"mb-4 opacity-40"}),l.jsx("p",{className:"text-xs font-bold uppercase tracking-widest opacity-60",children:n("Live capture required","Capture live requise")})]}),l.jsx("input",{id:"capture-photo",type:"file",accept:"image/*",capture:"environment",onChange:Oi,className:"sr-only"}),l.jsx("label",{htmlFor:"capture-photo",className:"relative z-10 mt-6 inline-flex items-center justify-center rounded-full border border-gray-200 bg-white/90 px-4 py-2 text-[10px] font-bold uppercase tracking-widest text-gray-600 shadow-sm backdrop-blur hover:bg-white",children:u?n("Retake Photo","Reprendre photo"):n("Capture Photo","Capturer photo")})]}),ft&&l.jsx("div",{className:"rounded-xl border border-red-100 bg-red-50 p-3 text-[10px] font-bold uppercase tracking-widest text-red-600",children:ft})]}),Ei=()=>o==="pharmacy"?l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-4",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900",children:n("Create Pharmacy","Creer une pharmacie")}),l.jsx("input",{value:ae,onChange:a=>bt(a.target.value),placeholder:n("Pharmacy name","Nom de la pharmacie"),className:"w-full h-12 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs font-semibold text-gray-600",children:n("Open now","Ouvert maintenant")}),l.jsx("button",{onClick:()=>St(a=>!a),className:`px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${oe?"bg-[#4c7c59] text-white":"bg-gray-100 text-gray-500"}`,children:oe?n("Yes","Oui"):n("No","Non")})]})]}):o==="mobile_money"?l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-4",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900",children:n("Create Kiosk","Creer un kiosque")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:De.map(a=>l.jsx("button",{onClick:()=>Ct(h=>ke(h,a)),className:`px-3 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${le.includes(a)?"bg-[#0f2b46] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))})]}):l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-4",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900",children:n("Create Fuel Station","Creer une station-service")}),l.jsx("input",{value:ae,onChange:a=>bt(a.target.value),placeholder:n("Fuel station name","Nom de la station-service"),className:"w-full h-12 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs font-semibold text-gray-600",children:n("Fuel available","Carburant disponible")}),l.jsx("button",{onClick:()=>wt(a=>!a),className:`px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${ce?"bg-[#4c7c59] text-white":"bg-gray-100 text-gray-500"}`,children:ce?n("Yes","Oui"):n("No","Non")})]})]}),ji=()=>l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-4",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900",children:n("Enrich Missing Fields","Enrichir les champs manquants")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(a=>l.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest px-2 py-1 rounded-full bg-[#fff8f4] text-[#b85f3f] border border-[#f5d5c6]",children:Ii(a)},a))}),A.includes("openingHours")&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:n("Opening hours","Heures d'ouverture")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Is.map(a=>l.jsx("button",{onClick:()=>xt(a),className:`px-3 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${q===a?"bg-[#0f2b46] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))}),l.jsx("input",{value:q,onChange:a=>xt(a.target.value),placeholder:n("Custom opening hours","Heures d'ouverture personnalisees"),className:"w-full h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"})]}),A.includes("isOpenNow")&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs font-semibold text-gray-600",children:n("Open now","Ouvert maintenant")}),l.jsx("button",{onClick:()=>St(a=>!a),className:`px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${oe?"bg-[#4c7c59] text-white":"bg-gray-100 text-gray-500"}`,children:oe?n("Yes","Oui"):n("No","Non")})]}),A.includes("isOnDuty")&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs font-semibold text-gray-600",children:n("On-call pharmacy","Pharmacie de garde")}),l.jsx("button",{onClick:()=>mi(a=>!a),className:`px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${We?"bg-[#4c7c59] text-white":"bg-gray-100 text-gray-500"}`,children:We?n("Yes","Oui"):n("No","Non")})]}),A.includes("providers")&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:n("Providers","Operateurs")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:De.map(a=>l.jsx("button",{onClick:()=>Ct(h=>ke(h,a)),className:`px-3 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${le.includes(a)?"bg-[#0f2b46] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))})]}),A.includes("merchantIdByProvider")&&l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("select",{value:$e,onChange:a=>bi(a.target.value),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs",children:De.map(a=>l.jsx("option",{value:a,children:a},a))}),l.jsx("input",{value:pe,onChange:a=>yi(a.target.value),placeholder:n("Merchant ID","ID marchand"),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"})]}),A.includes("paymentMethods")&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:n("Payment methods","Moyens de paiement")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:ks.map(a=>l.jsx("button",{onClick:()=>xi(h=>ke(h,a)),className:`px-3 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${Y.includes(a)?"bg-[#0f2b46] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))})]}),A.includes("fuelTypes")&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:n("Fuel types","Types de carburant")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Ze.map(a=>l.jsx("button",{onClick:()=>Si(h=>ke(h,a)),className:`px-3 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${ge.includes(a)?"bg-[#0f2b46] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))})]}),A.includes("pricesByFuel")&&l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx("select",{value:_e,onChange:a=>Ci(a.target.value),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs",children:Ze.map(a=>l.jsx("option",{value:a,children:a},a))}),l.jsx("input",{type:"number",value:we,onChange:a=>wi(a.target.value),placeholder:n("Price (XAF)","Prix (XAF)"),className:"h-11 bg-gray-50 border border-gray-100 rounded-xl px-3 text-xs"})]}),A.includes("quality")&&l.jsx("div",{className:"flex gap-2",children:["Premium","Standard","Low"].map(a=>l.jsx("button",{onClick:()=>vi(a),className:`flex-1 h-10 rounded-xl text-[10px] font-bold uppercase tracking-widest ${ve===a?"bg-[#4c7c59] text-white":"bg-gray-50 text-gray-500"}`,children:a},a))}),A.includes("hasFuelAvailable")&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs font-semibold text-gray-600",children:n("Fuel available","Carburant disponible")}),l.jsx("button",{onClick:()=>wt(a=>!a),className:`px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest ${ce?"bg-[#4c7c59] text-white":"bg-gray-100 text-gray-500"}`,children:ce?n("Yes","Oui"):n("No","Non")})]})]}),Bi=o==="pharmacy"?l.jsx(Wi,{size:18}):o==="mobile_money"?l.jsx($i,{size:18}):l.jsx(_i,{size:18});return pi?l.jsxs("div",{className:"flex flex-col h-full bg-[#f9fafb]",children:[l.jsx("div",{className:"pt-6 px-8",children:l.jsx("button",{onClick:r,className:"p-1 -ml-1 text-gray-500",children:l.jsx(Nt,{size:24})})}),l.jsxs("div",{className:"flex-1 px-6 flex flex-col items-center justify-center text-center space-y-4",children:[l.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[#eaf3ee] text-[#4c7c59] flex items-center justify-center",children:l.jsx(Zi,{size:30})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:n("Saved Offline","Enregistre hors ligne")}),l.jsx("p",{className:"text-sm text-gray-500",children:n("Your submission is saved locally first and will sync automatically when online.","Votre soumission est d'abord enregistree localement et sera synchronisee automatiquement en ligne.")}),Ce&&l.jsx("div",{className:"w-full rounded-xl border border-[#d5e1eb] bg-white p-3 text-xs text-[#0f2b46]",children:Ce})]}),l.jsx("div",{className:"p-6",children:l.jsx("button",{onClick:e,className:"w-full h-14 bg-[#c86b4a] text-white rounded-xl font-bold uppercase text-xs tracking-widest shadow-lg hover:bg-[#b85f3f] active:scale-95 transition-all",children:n("Return to Map","Retour a la carte")})})]}):l.jsxs("div",{className:"flex flex-col h-full bg-[#f9fafb]",children:[l.jsxs("div",{className:"pt-6 px-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("button",{onClick:r,className:"p-1 -ml-1 text-gray-500",children:l.jsx(Nt,{size:24})}),l.jsx("span",{className:"text-xs font-bold text-gray-900 uppercase tracking-[0.2em]",children:E?n("Enrich Point","Enrichir point"):n("Create Point","Creer point")}),l.jsx("span",{className:"w-6"})]}),l.jsxs("div",{className:"flex items-center space-x-2 text-[10px] font-bold uppercase tracking-widest text-[#4c7c59] mb-4",children:[l.jsx(Hi,{size:12}),l.jsx("span",{children:n("Live photo + GPS mandatory","Photo live + GPS obligatoires")})]})]}),l.jsxs("div",{className:"flex-1 p-6 overflow-y-auto no-scrollbar space-y-5",children:[l.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-[#0f2b46]",children:[Bi,l.jsx("span",{className:"text-sm font-bold",children:o==="pharmacy"?n("Pharmacy","Pharmacie"):o==="mobile_money"?n("Mobile Money Kiosk","Kiosque mobile money"):n("Fuel Station","Station-service")})]}),E&&s&&l.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 truncate max-w-[140px]",children:s.name})]}),Fi(),Ui(),Ri(),E?ji():Ei(),gt&&l.jsx("div",{className:"rounded-xl border border-red-100 bg-red-50 p-3 text-[10px] font-bold uppercase tracking-widest text-red-600",children:gt}),Ce&&l.jsx("div",{className:"rounded-xl border border-[#d5e1eb] bg-white p-3 text-xs text-[#0f2b46]",children:Ce})]}),l.jsx("div",{className:"p-6 pt-2",children:l.jsx("button",{onClick:Li,disabled:mt,className:"w-full h-14 bg-[#0f2b46] text-white rounded-xl font-bold uppercase text-xs tracking-widest shadow-lg flex items-center justify-center space-x-2 hover:bg-[#0b2236] active:scale-95 transition-all disabled:opacity-70",children:mt?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:n("Saving","Enregistrement")})]}):l.jsx("span",{children:E?n("Save Enrichment","Enregistrer enrichissement"):n("Create Point","Creer point")})})})]})};export{js as default};
